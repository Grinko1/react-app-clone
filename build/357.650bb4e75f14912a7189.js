"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[357],{9561:(e,t,r)=>{r.r(t),r.d(t,{default:()=>$});var a=r(885),n=r(3007),i=r(1072),o=r(7294),s=r(1233),c=r(9970),l=r(5401),u=r(8979),d=r(7500),v=r(9319),p=r(6425),f=r(8312),g=r(5861),h=r(4687),m=r.n(h),y=r(4268);var P=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.isLoading)||!1},w=function(e){var t;return null===(t=e.articlesPage)||void 0===t?void 0:t.error},S=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.view)||d.GA.SMALL},x=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.page)||1},A=function(e){var t,r;return null!==(t=null===(r=e.articlesPage)||void 0===r?void 0:r.order)&&void 0!==t?t:"asc"},C=function(e){var t,r;return null!==(t=null===(r=e.articlesPage)||void 0===r?void 0:r.sort)&&void 0!==t?t:d.$B.CREATED},j=function(e){var t,r;return null!==(t=null===(r=e.articlesPage)||void 0===r?void 0:r.search)&&void 0!==t?t:""},L=function(e){var t,r;return null!==(t=null===(r=e.articlesPage)||void 0===r?void 0:r.type)&&void 0!==t?t:d.Iq.ALL},k=(0,y.hg)("articlesPage/fetchArticlesList",function(){var e=(0,g.Z)(m().mark((function e(t,r){var n,i,o,s,c,l,u,v,p,f;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.extra,i=r.rejectWithValue,g=(o=r.getState)(),void 0,s=(null===(h=g.articlesPage)||void 0===h?void 0:h.limit)||9,c=C(o()),l=A(o()),u=j(o()),v=x(o()),p=L(o()),e.prev=7,t={sort:c,order:l,search:u,type:p},window.history.pushState(null,"",function(e){var t=new URLSearchParams(window.location.search);return Object.entries(e).forEach((function(e){var r=(0,a.Z)(e,2),n=r[0],i=r[1];void 0!==i&&t.set(n,i)})),"?".concat(t.toString())}(t)),e.next=11,n.api.get("/articles",{params:{_expand:"user",_limit:s,_page:v,_sort:c,_order:l,q:u,type:p===d.Iq.ALL?void 0:p}});case 11:if((f=e.sent).data){e.next=14;break}throw new Error;case 14:return e.abrupt("return",f.data);case 17:return e.prev=17,e.t0=e.catch(7),e.abrupt("return",i("error"));case 20:case"end":return e.stop()}var t,g,h}),e,null,[[7,17]])})));return function(t,r){return e.apply(this,arguments)}}());const b={sortWrapper:"pyOjonnp",search:"QkNSez8q",tabs:"JHbc4jKB"};var T=r(1283),N=(0,y.HF)({selectId:function(e){return e.id}}),I=N.getSelectors((function(e){return e.articlesPage||N.getInitialState()})),_=(0,y.oM)({name:"articlesPageSlice",initialState:N.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},view:d.GA.SMALL,page:1,hasMore:!0,_inited:!1,limit:9,sort:d.$B.CREATED,search:"",order:"asc",type:d.Iq.ALL}),reducers:{setView:function(e,t){e.view=t.payload,localStorage.setItem(T.f,t.payload)},setPage:function(e,t){e.page=t.payload},setOrder:function(e,t){e.order=t.payload},setSort:function(e,t){e.sort=t.payload},setType:function(e,t){e.type=t.payload},setSearch:function(e,t){e.search=t.payload},initState:function(e){var t=localStorage.getItem(T.f);e.view=t,e.limit=t===d.GA.BIG?4:9,e._inited=!0}},extraReducers:function(e){e.addCase(k.pending,(function(e,t){e.error=void 0,e.isLoading=!0,t.meta.arg.replace&&N.removeAll(e)})).addCase(k.fulfilled,(function(e,t){e.isLoading=!1,e.hasMore=t.payload.length>=e.limit,t.meta.arg.replace?N.setAll(e,t.payload):N.addMany(e,t.payload)})).addCase(k.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}),E=_.reducer,G=_.actions,M=r(5893),q=(0,o.memo)((function(e){var t,r,a=e.className,s=(0,i.$G)().t,c=(0,l.T)(),u=(0,v.v9)(S),g=(0,v.v9)(C),h=(0,v.v9)(A),m=(0,v.v9)(j),y=(0,v.v9)(L),P=(0,o.useCallback)((function(){c(k({replace:!0}))}),[c]),w=(t=P,500,r=(0,o.useRef)(),(0,o.useCallback)((function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];r.current&&clearTimeout(r.current),r.current=setTimeout((function(){t.apply(void 0,a)}),500)}),[t,500])),x=(0,o.useCallback)((function(e){c(G.setView(e))}),[c]),T=(0,o.useCallback)((function(e){c(G.setSort(e)),c(G.setPage(1)),P()}),[c,P]),N=(0,o.useCallback)((function(e){c(G.setOrder(e)),c(G.setPage(1)),P()}),[c,P]),I=(0,o.useCallback)((function(e){c(G.setSearch(e)),c(G.setPage(1)),w()}),[c,w]),_=(0,o.useCallback)((function(e){c(G.setType(e)),c(G.setPage(1)),P()}),[c,P]);return(0,M.jsxs)("div",{className:(0,n.A)(b.ArticlesPageFilters,{},[a]),children:[(0,M.jsxs)("div",{className:b.sortWrapper,children:[(0,M.jsx)(d.xT,{order:h,sort:g,onChangeOrder:N,onChangeSort:T}),(0,M.jsx)(d.Vv,{view:u,onViewClick:x})]}),(0,M.jsx)(p.Z,{className:b.search,children:(0,M.jsx)(f.I,{onChange:I,value:m,placeholder:s("Поиск")})}),(0,M.jsx)(d.XL,{value:y,onChangeType:_,className:b.tabs})]})})),O=r(9655),Z=(0,y.hg)("articlesPage/fetchNextArticlesPage",function(){var e=(0,g.Z)(m().mark((function e(t,r){var a,n,i,o,s;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.getState,n=r.dispatch,t=a(),void 0,i=null===(c=t.articlesPage)||void 0===c?void 0:c.hasMore,o=x(a()),s=P(a()),i&&!s&&(n(G.setPage(o+1)),n(k({})));case 5:case"end":return e.stop()}var t,c}),e)})));return function(t,r){return e.apply(this,arguments)}}()),R=(0,y.hg)("articlesPage/initArticlesPage",function(){var e=(0,g.Z)(m().mark((function e(t,r){var a,n,i,o,s,c;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.getState,n=r.dispatch,void 0,(null===(l=a().articlesPage)||void 0===l?void 0:l._inited)||(i=t.get("order"),o=t.get("sort"),s=t.get("search"),c=t.get("type"),i&&n(G.setOrder(i)),o&&n(G.setSort(o)),s&&n(G.setSearch(s)),c&&n(G.setType(c)),n(G.initState()),n(k({})));case 3:case"end":return e.stop()}var l}),e)})));return function(t,r){return e.apply(this,arguments)}}());var V=(0,o.memo)((function(e){e.className;var t=(0,v.v9)(I.selectAll),r=(0,v.v9)(P),a=(0,v.v9)(S);return(0,v.v9)(w),(0,M.jsx)(d.wD,{isLoading:r,view:a,articles:t,className:"list"})})),B={articlesPage:E},W=function(e){var t=e.className,r=((0,i.$G)().t,(0,l.T)()),d=(0,O.lr)(),v=(0,a.Z)(d,1)[0],p=(0,o.useCallback)((function(){r(Z())}),[r]);return(0,c.Q)((function(){r(R(v))})),(0,M.jsx)(s.W,{reducers:B,removeAfterUnmount:!1,children:(0,M.jsxs)(u.T,{onScrollEnd:p,className:(0,n.A)("i0h17Gqm",{},[t]),children:[(0,M.jsx)(q,{}),(0,M.jsx)(V,{})]})})};const $=(0,o.memo)(W)}}]);