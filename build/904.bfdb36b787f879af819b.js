"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[904],{5550:(e,t,r)=>{r.d(t,{U:()=>c,g:()=>o.g});var n=r(4942),a=r(3562),i=r(5893);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var c=function(e){return(0,i.jsx)(a.k,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({direction:"row"},e))},o=r(4092)},1153:(e,t,r)=>{r.r(t),r.d(t,{default:()=>de});var n=r(3007),a=r(1072),i=r(7294),s=r(7500),c=r(9250),o=r(1233),l=r(8979);const u="adu8fSDx";var d=r(7779),m=r(4268),v=r(5861),f=r(4687),x=r.n(f),p=(0,m.hg)("articleDetailsPage/fetchArticleRecommendations",function(){var e=(0,v.Z)(x().mark((function e(t,r){var n,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.extra,a=r.rejectWithValue,e.prev=1,e.next=4,n.api.get("/articles",{params:{_limit:4}});case 4:if((i=e.sent).data){e.next=7;break}throw new Error;case 7:return e.abrupt("return",i.data);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",a("error"));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}()),h=(0,m.HF)({selectId:function(e){return e.id}}),j=(h.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.recommendations)||h.getInitialState()})),(0,m.oM)({name:"articleDetailsPageRecommendationsSlice",initialState:h.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(p.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(p.fulfilled,(function(e,t){e.isLoading=!1,h.setAll(e,t.payload)})).addCase(p.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer),g=(0,m.hg)("articleDetails/fetchCommentsByArticleId",function(){var e=(0,v.Z)(x().mark((function e(t,r){var n,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.extra,a=r.rejectWithValue,t){e.next=3;break}return e.abrupt("return",a("error"));case 3:return e.prev=3,e.next=6,n.api.get("/comments",{params:{articleId:t,_expand:"user"}});case 6:if((i=e.sent).data){e.next=9;break}throw new Error;case 9:return e.abrupt("return",i.data);case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",a("error"));case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,r){return e.apply(this,arguments)}}()),b=(0,m.HF)({selectId:function(e){return e.id}}),N=b.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.comments)||b.getInitialState()})),w=(0,m.oM)({name:"articleDetailsCommentsSlice",initialState:b.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(g.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(g.fulfilled,(function(e,t){e.isLoading=!1,b.setAll(e,t.payload)})).addCase(g.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,C=(0,d.UY)({recommendations:j,comments:w}),L=r(2301),y=r(5255),O=r(9319),k=r(3918),A=r(2222),S=r(9717),D=(0,A.P1)(s.wq,S.m5,(function(e,t){return!(!e||!t)&&e.user.id===t.id}));var P=r(5893),I=(0,i.memo)((function(e){var t=e.className,r=(0,a.$G)().t,s=(0,c.s0)(),o=(0,O.v9)(D),l=(0,O.v9)(k.wq),u=(0,i.useCallback)((function(){s(L.h3.articles)}),[s]),d=(0,i.useCallback)((function(){s("".concat(L.h3.article_details).concat(null==l?void 0:l.id,"/edit"))}),[null==l?void 0:l.id,s]);return(0,P.jsxs)("div",{className:(0,n.A)("PF3DYqSS",{},[t]),children:[(0,P.jsx)(y.zx,{theme:y.bn.OUTLINE,onClick:u,children:r("Назад к списку")}),o&&(0,P.jsx)(y.zx,{className:"XdnP3e6a",theme:y.bn.OUTLINE,onClick:d,children:r("Редактировать")})]})}));const F={};var T=r(1715),E=r(5550),_=r(6628).p.injectEndpoints({endpoints:function(e){return{getArticleRecommendationsList:e.query({query:function(e){return{url:"/articles",params:{_limit:e}}}})}}}).useGetArticleRecommendationsListQuery,q=(0,i.memo)((function(e){var t=e.className,r=(0,a.$G)().t,i=_(3),c=i.isLoading,o=i.data;return i.error,(0,P.jsxs)(E.g,{gap:"8",className:(0,n.A)(F.ArticleRecommendationsList,{},[t]),children:[(0,P.jsx)(T.xv,{size:T.yH.L,className:F.commentTitle,title:r("Рекомендуем")}),!c&&o&&(0,P.jsx)(s.wD,{articles:o,isLoading:!1,className:F.recommendations,target:"_blank"})]})}));const z={};var G=r(8312),H=r(5401),R=(0,m.oM)({name:"addCommentForm",initialState:{text:""},reducers:{setText:function(e,t){e.text=t.payload}}}),U=R.actions,W=R.reducer,Z=function(e){var t,r;return null!==(t=null===(r=e.addCommentForm)||void 0===r?void 0:r.text)&&void 0!==t?t:""},$=function(e){var t;return null===(t=e.addCommentForm)||void 0===t?void 0:t.error};var M={addCommentForm:W};const V=(0,i.memo)((function(e){var t=e.className,r=e.onSendComment,s=(0,a.$G)().t,c=(0,O.v9)(Z),l=((0,O.v9)($),(0,H.T)()),u=(0,i.useCallback)((function(e){l(U.setText(e))}),[l]),d=(0,i.useCallback)((function(){r(c||""),u("")}),[u,r,c]);return(0,P.jsx)(o.W,{reducers:M,children:(0,P.jsxs)("div",{className:(0,n.A)("ZrfoeB3H",{},[t]),children:[(0,P.jsx)(G.I,{className:"gxRAkJ0f",placeholder:s("Введите текст комментария"),value:c,onChange:u}),(0,P.jsx)(y.zx,{theme:y.bn.OUTLINE,onClick:d,children:s("Отправить")})]})})})),B={comment:"zo5NFi5H"};var K=r(2949),Q=r(3312),Y=r(6897);const J="xIHByGcu",X="dsH_3Oqu",ee="Ks7Kyp_K",te="dw82WMzO";var re=(0,i.memo)((function(e){var t=e.className,r=e.comment;return e.isLoading?(0,P.jsxs)("div",{className:(0,n.A)(J,{},[t,"V0iZ1Un3"]),children:[(0,P.jsxs)("div",{className:X,children:[(0,P.jsx)(Q.O,{width:30,height:30,border:"50%"}),(0,P.jsx)(Q.O,{height:16,width:100,className:te})]}),(0,P.jsx)(Q.O,{className:ee,width:"100%",height:50})]}):r?(0,P.jsxs)("div",{className:(0,n.A)(J,{},[t]),children:[(0,P.jsxs)(Y.F,{to:"".concat(L.h3.profile).concat(r.user.id),className:X,children:[r.user.avatar?(0,P.jsx)(K.q,{size:30,src:r.user.avatar}):null,(0,P.jsx)(T.xv,{className:te,title:r.user.username})]}),(0,P.jsx)(T.xv,{className:ee,text:r.text})]}):null})),ne=(0,i.memo)((function(e){var t=e.className,r=e.isLoading,i=e.comments,s=(0,a.$G)().t;return r?(0,P.jsxs)("div",{className:(0,n.A)(B.CommentList,{},[t]),children:[(0,P.jsx)(re,{isLoading:!0}),(0,P.jsx)(re,{isLoading:!0}),(0,P.jsx)(re,{isLoading:!0})]}):(0,P.jsx)("div",{className:(0,n.A)(B.CommentList,{},[t]),children:null!=i&&i.length?i.map((function(e){return(0,P.jsx)(re,{isLoading:r,className:B.comment,comment:e},e.id)})):(0,P.jsx)(T.xv,{text:s("Комментарии отсутствуют")})})})),ae=function(e){var t;return null===(t=e.articleDetailsPage)||void 0===t||null===(t=t.comments)||void 0===t?void 0:t.isLoading},ie=(0,m.hg)("articleDetails/addCommentForArticle",function(){var e=(0,v.Z)(x().mark((function e(t,r){var n,a,i,s,c,o,l;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.extra,a=r.dispatch,i=r.rejectWithValue,s=r.getState,c=(0,S.m5)(s()),o=(0,k.wq)(s()),c&&t&&o){e.next=5;break}return e.abrupt("return",i("no data"));case 5:return e.prev=5,e.next=8,n.api.post("/comments",{articleId:o.id,userId:c.id,text:t});case 8:if((l=e.sent).data){e.next=11;break}throw new Error;case 11:return a(g(o.id)),e.abrupt("return",l.data);case 15:return e.prev=15,e.t0=e.catch(5),e.abrupt("return",i("error"));case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,r){return e.apply(this,arguments)}}()),se=r(9970),ce=r(379),oe=(0,i.memo)((function(e){var t=e.className,r=e.id,s=(0,O.I0)(),c=(0,a.$G)("article-details").t,o=(0,O.v9)(N.selectAll),l=(0,O.v9)(ae);(0,se.Q)((function(){s(g(r))}));var u=(0,i.useCallback)((function(e){s(ie(e))}),[s]);return(0,P.jsxs)("div",{className:(0,n.A)(z.ArticleDetailsComments,{},[t]),children:[(0,P.jsx)(T.xv,{size:T.yH.L,className:z.commentTitle,title:c("Комментарии")}),(0,P.jsx)(i.Suspense,{fallback:(0,P.jsx)(ce.a,{}),children:(0,P.jsx)(V,{onSendComment:u})}),(0,P.jsx)(ne,{isLoading:l,comments:o})]})})),le={articleDetailsPage:C},ue=function(e){var t=e.className,r=(0,a.$G)("article-details").t,i=(0,c.UO)().id;return i?(0,P.jsx)(o.W,{reducers:le,removeAfterUnmount:!0,children:(0,P.jsxs)(l.T,{className:(0,n.A)(u,{},[t]),children:[(0,P.jsx)(I,{}),(0,P.jsx)(s.D0,{id:i}),(0,P.jsx)(q,{}),(0,P.jsx)(oe,{id:i})]})}):(0,P.jsx)(l.T,{className:(0,n.A)(u,{},[t]),children:r("Статья не найдена")})};const de=(0,i.memo)(ue)}}]);